# 画面設計書

## 画面一覧

| # | 画面名 | パス | 説明 |
|---|--------|------|------|
| 1 | ダッシュボード | `/` | 月間シフト概要、クイックアクション |
| 2 | スタッフ管理 | `/staffs` | スタッフの一覧・追加・編集・削除 |
| 3 | シフト希望入力 | `/requests` | カレンダー形式でシフト希望を入力 |
| 4 | 制約設定 | `/constraints` | 制約条件の一覧・追加・編集 |
| 5 | シフト生成 | `/generate` | LLM によるシフト生成・パターン比較 |
| 6 | シフト編集 | `/shifts/:patternId/edit` | 選択パターンの手動編集 |

## レイアウト

```
┌─────────────────────────────────────────────────┐
│  ヘッダー: アプリ名 + 対象年月セレクター           │
├──────────┬──────────────────────────────────────┤
│          │                                      │
│ サイド   │          メインコンテンツ              │
│ ナビ     │                                      │
│          │                                      │
│ ・ダッシュ│                                      │
│ ・スタッフ│                                      │
│ ・希望入力│                                      │
│ ・制約設定│                                      │
│ ・シフト  │                                      │
│   生成   │                                      │
│          │                                      │
└──────────┴──────────────────────────────────────┘
```

---

## 各画面の詳細

### 1. ダッシュボード (`/`)

**目的:** 当月のシフト状況を俯瞰する

```
┌──────────────────────────────────────────────────────┐
│  2026年3月のシフト状況                                │
├──────────────┬──────────────┬──────────────┬─────────┤
│ スタッフ数    │ 希望提出率    │ シフト状態    │ 制約数   │
│     8人      │   6/8 (75%)  │  生成済み     │  5件    │
└──────────────┴──────────────┴──────────────┴─────────┘
│                                                      │
│  [ミニカレンダー: 月間シフト概要]                       │
│  ※ 日付ごとの出勤予定人数をヒートマップ的に表示         │
│                                                      │
│  クイックアクション:                                   │
│  [シフト希望を入力] [シフトを生成] [PDFを出力]          │
└──────────────────────────────────────────────────────┘
```

### 2. スタッフ管理 (`/staffs`)

**目的:** 従業員情報のCRUD

```
┌──────────────────────────────────────────────────────┐
│  スタッフ管理                          [+ 新規追加]   │
├──────────────────────────────────────────────────────┤
│                                                      │
│  ┌─────┬────────┬─────┬──────┬─────────┐             │
│  │ 名前 │ 役割   │ 雇用 │ 状態 │ 操作    │             │
│  ├─────┼────────┼─────┼──────┼─────────┤             │
│  │田中  │キッチン │正社員│ 有効 │ 編集|削除│             │
│  │佐藤  │ホール  │パート│ 有効 │ 編集|削除│             │
│  └─────┴────────┴─────┴──────┴─────────┘             │
│                                                      │
└──────────────────────────────────────────────────────┘

[新規追加/編集モーダル]
┌──────────────────────────────┐
│  スタッフ登録                 │
│                              │
│  名前:     [           ]     │
│  役割:     [キッチン ▼ ]     │
│  雇用形態: [正社員   ▼ ]     │
│                              │
│         [キャンセル] [保存]   │
└──────────────────────────────┘
```

### 3. シフト希望入力 (`/requests`)

**目的:** スタッフごとのシフト希望をカレンダー上で入力

```
┌──────────────────────────────────────────────────────┐
│  シフト希望入力  スタッフ: [田中太郎 ▼]  2026年3月    │
├──────────────────────────────────────────────────────┤
│  月間希望時間: [80] 〜 [120] 時間                      │
│                                                      │
│  ┌────┬────┬────┬────┬────┬────┬────┐               │
│  │ 月  │ 火  │ 水  │ 木  │ 金  │ 土  │ 日  │               │
│  ├────┼────┼────┼────┼────┼────┼────┤               │
│  │ 1   │ 2   │ 3   │ 4   │ 5   │ 6   │ 7   │               │
│  │ ○  │ ×  │ ○  │ △  │ ○  │ ○  │ ×  │               │
│  │9-17 │    │9-17 │PM希望│9-17 │10-18│    │               │
│  ├────┼────┼────┼────┼────┼────┼────┤               │
│  │ 8   │ 9   │ ...                                   │
│  └────┴────┴─────────────────────────┘               │
│                                                      │
│  凡例: ○出勤可  ×不可  △希望  (クリックで切替)       │
│                                                      │
│  [一括設定: 毎週水曜を休みにする] [保存]               │
└──────────────────────────────────────────────────────┘
```

**操作:**
- 日付セルをクリック → available/unavailable/preferred を切り替え
- セルを長押しまたはダブルクリック → 時間帯入力ポップオーバー
- 一括設定で「毎週◯曜休み」等のパターン入力が可能

### 4. 制約設定 (`/constraints`)

**目的:** シフト生成時の制約条件を管理

```
┌──────────────────────────────────────────────────────┐
│  制約設定                              [+ 制約追加]   │
├──────────────────────────────────────────────────────┤
│  ハード制約（必ず守る）                                │
│  ┌───────────────────────────────┬──────┬─────────┐  │
│  │ ランチタイム(11-14時)最低3名   │ 有効 │ 編集|削除│  │
│  │ 連勤5日以上禁止               │ 有効 │ 編集|削除│  │
│  │ 勤務間インターバル11時間       │ 有効 │ 編集|削除│  │
│  └───────────────────────────────┴──────┴─────────┘  │
│                                                      │
│  ソフト制約（できるだけ守る）                           │
│  ┌───────────────────────────────┬────┬──────┬────┐  │
│  │ 田中・佐藤を同シフトに         │ P:3│ 有効 │ 操作│  │
│  │ パート月80h目安               │ P:2│ 有効 │ 操作│  │
│  └───────────────────────────────┴────┴──────┴────┘  │
└──────────────────────────────────────────────────────┘

[制約追加モーダル]
┌──────────────────────────────────┐
│  制約を追加                       │
│                                  │
│  制約名:   [                  ]  │
│  種類:     [ハード制約 ▼]        │
│  カテゴリ: [最低スタッフ数 ▼]    │
│                                  │
│  ── カテゴリに応じた設定項目 ──  │
│  時間帯: [11:00] 〜 [14:00]     │
│  最低人数: [3]                   │
│                                  │
│           [キャンセル] [保存]     │
└──────────────────────────────────┘
```

### 5. シフト生成 (`/generate`)

**目的:** LLM でシフトを自動生成し、パターンを比較する

```
┌──────────────────────────────────────────────────────┐
│  シフト自動生成  2026年3月                             │
├──────────────────────────────────────────────────────┤
│                                                      │
│  生成条件:                                            │
│  ・スタッフ: 8名 (希望提出: 8/8)                      │
│  ・ハード制約: 3件 / ソフト制約: 2件                   │
│  ・生成パターン数: [3 ▼]                              │
│                                                      │
│              [シフトを生成する]                        │
│                                                      │
│  ─── 生成中 ─────────────────────                    │
│  ████████████░░░░ 75% パターン3生成中...              │
│                                                      │
│  ─── 生成結果 ───────────────────                    │
│  ┌──────────┬──────────┬──────────┐                  │
│  │パターン1  │パターン2  │パターン3  │                  │
│  │スコア: 92 │スコア: 87 │スコア: 78│                  │
│  │違反: 0件  │違反: 1件  │違反: 2件 │                  │
│  │           │           │          │                  │
│  │[詳細を見る]│[詳細を見る]│[詳細を見る]│                  │
│  │[選択する] │[選択する] │[選択する] │                  │
│  └──────────┴──────────┴──────────┘                  │
│                                                      │
│  パターン1の詳細:                                     │
│  「全員の希望を最大限反映しました。ランチタイムは       │
│   毎日3名以上を確保し、連勤は最大4日に抑えています。」  │
│                                                      │
│  [ミニカレンダー: パターン1のシフト表プレビュー]        │
│                                                      │
└──────────────────────────────────────────────────────┘
```

### 6. シフト編集 (`/shifts/:patternId/edit`)

**目的:** 選択したパターンを手動で微調整し、確定する

```
┌──────────────────────────────────────────────────────┐
│  シフト編集  2026年3月  パターン1 (スコア: 92)         │
│                                    [PDF出力] [確定]   │
├──────────────────────────────────────────────────────┤
│                                                      │
│  ┌─────┬──────┬──────┬──────┬──────┬──────┬──────┐  │
│  │      │ 3/1月│ 3/2火│ 3/3水│ 3/4木│ 3/5金│ 3/6土│  │
│  ├─────┼──────┼──────┼──────┼──────┼──────┼──────┤  │
│  │田中  │ 9-17 │ 休み │ 9-17 │ 9-17 │ 9-17 │10-18 │  │
│  │佐藤  │10-15 │10-15 │ 休み │10-15 │ 休み │10-15 │  │
│  │鈴木  │ 休み │ 9-17 │ 9-17 │ 休み │ 9-17 │ 9-17 │  │
│  │ ...  │      │      │      │      │      │      │  │
│  └─────┴──────┴──────┴──────┴──────┴──────┴──────┘  │
│                  ← 前の週    次の週 →                  │
│                                                      │
│  ※ セルをクリックして時間を編集                        │
│  ※ ドラッグ&ドロップでシフトを移動                     │
│  ※ 手動編集したセルは色で区別表示                      │
│                                                      │
│  サマリー:                                            │
│  ┌─────┬──────┬──────┬──────┐                        │
│  │名前  │月間H │希望H  │差分  │                        │
│  │田中  │ 152h │ 160h │ -8h  │                        │
│  │佐藤  │  78h │  80h │ -2h  │                        │
│  └─────┴──────┴──────┴──────┘                        │
│                                                      │
│  ⚠ 警告: 3/15(金)のランチタイムが2名です（最低3名）    │
│                                                      │
└──────────────────────────────────────────────────────┘
```

## コンポーネント構成

```
src/components/
├── Layout/
│   ├── AppLayout.tsx          # 全体レイアウト（サイドナビ+ヘッダー+メイン）
│   ├── Sidebar.tsx            # サイドナビゲーション
│   └── Header.tsx             # ヘッダー（年月セレクター含む）
├── Calendar/
│   ├── ShiftCalendar.tsx      # FullCalendar ラッパー
│   ├── RequestCalendar.tsx    # シフト希望入力用カレンダー
│   └── ShiftGrid.tsx          # シフト編集用グリッド表
├── Common/
│   ├── Modal.tsx              # モーダル
│   ├── Button.tsx             # ボタン
│   ├── Select.tsx             # セレクト
│   ├── Badge.tsx              # バッジ（状態表示）
│   └── LoadingSpinner.tsx     # ローディング
├── Staff/
│   ├── StaffList.tsx          # スタッフ一覧テーブル
│   └── StaffForm.tsx          # スタッフ登録/編集フォーム
├── Constraint/
│   ├── ConstraintList.tsx     # 制約一覧
│   └── ConstraintForm.tsx     # 制約登録/編集フォーム
├── Shift/
│   ├── PatternCard.tsx        # パターン比較カード
│   ├── PatternDetail.tsx      # パターン詳細
│   ├── ShiftEntryEditor.tsx   # エントリ編集ポップオーバー
│   ├── StaffHoursSummary.tsx  # スタッフ別時間サマリー
│   └── ValidationWarnings.tsx # バリデーション警告
└── PDF/
    └── ShiftPDFExporter.tsx   # PDF出力
```
